<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>BCD-UI Export Detail</title>
  <script type="text/javascript" src="../bcdui/bcdui.js"></script>
</head>
<body>
  <div id="bcdMainContainer">

    <div id="bcdContextMenuDiv" style="display:none"></div>
    <div id="bcdTooltipDiv"     style="display:none"></div>
    <div id="bcdModalBoxDiv"    style="display:none"></div>

    <div id="bcdHeaderArea"><div id="bcdLogoImageArea"></div></div>
    <div id="bcdSpacerArea"></div>

    <div class="bcdContentContainer">
      <div id="bcdSideBarContainer">
        <div class="bcdSection">
          <div class="bcdItem">
          </div>
        </div>
      </div>

      <div id="bcdBodyContainer">
        <div class="bcdCaption">Page Caption</div>

        <!-- tag::exportHtml[] -->
        <bcd-periodChooser
            caption="Export date"
            targetModelXPath="$wrq/*/wrq:Select/f:Filter/f:And[@id='dy']"></bcd-periodChooser> <!--1-->
        <bcd-buttonNg caption="Export detail data" onClickAction="exportData()"></bcd-buttonNg>
        <!-- end::exportHtml[] -->

        <!-- tag::exportWysiwygExcel[] -->
        <bcd-buttonNg
            caption="Export report to Excel"
            onClickAction="bcdui.component.exports.exportWysiwygAsExcel({rootElement: 'exportDiv'})"></bcd-buttonNg>
        <!-- end::exportWysiwygExcel[] -->
        <p></p>

        <div id="exportDiv">
          <bcd-renderer inputModel="wrs"></bcd-renderer>
        </div>

      </div>
    </div>

  </div>
  <script type="text/javascript">
    var wrs = new bcdui.core.SimpleModel( { id: "wrs", url: "../sampleWrs.xml" } );

    // tag::exportJs[]
    var wrq = new bcdui.core.SimpleModel( { id: "wrq", url: "wrq.xml" } );
    function exportData() {
      bcdui.component.exports.excel.detailExport( { wrq: wrq, fileName: 'exportFile.slk' } );
    }
    // end::exportJs[]
  </script>

</body>
</html>